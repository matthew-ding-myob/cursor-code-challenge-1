<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrolling Background</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="backgroundCanvas"></canvas>
    <script>
        const canvas = document.getElementById('backgroundCanvas');
        const ctx = canvas.getContext('2d');

        // Set canvas size to fill the window
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const backgroundImage = new Image();
        backgroundImage.src = '../assets/city_background.png';

        const cassowaryImage = new Image();
        cassowaryImage.src = '../assets/cassowary.png';

        let x1 = 0;
        let x2;

        let cassowaryY = (canvas.height - cassowaryImage.height * 0.8) / 2;
        let isJumping = false;
        let jumpVelocity = 0;
        const gravity = 0.5;

        document.addEventListener('keydown', (event) => {
            if (event.code === 'Space' && !isJumping) {
                isJumping = true;
                jumpVelocity = -15; // Increased initial jump velocity for higher jump
            }
        });

        function updateCassowaryPosition() {
            if (isJumping) {
                cassowaryY += jumpVelocity;
                jumpVelocity += gravity;

                // Stop jumping when cassowary returns to original position
                const originalY = (canvas.height - cassowaryImage.height * 0.8) / 2;
                if (cassowaryY >= originalY) {
                    cassowaryY = originalY;
                    isJumping = false;
                }
            }
        }

        backgroundImage.onload = () => {
            x2 = backgroundImage.width * 2.5;

            cassowaryImage.onload = () => {
                function draw() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    // Draw the scrolling background
                    ctx.drawImage(backgroundImage, x1, 0, backgroundImage.width * 2.5, backgroundImage.height * 1.5);
                    ctx.drawImage(backgroundImage, x2, 0, backgroundImage.width * 2.5, backgroundImage.height * 1.5);

                    // Update cassowary position
                    updateCassowaryPosition();

                    // Draw the cassowary image in the middle of the left third of the screen with reduced size
                    const cassowaryWidth = cassowaryImage.width * 0.8;
                    const cassowaryHeight = cassowaryImage.height * 0.8;
                    const cassowaryX = (canvas.width / 3 - cassowaryWidth) / 2;
                    ctx.drawImage(cassowaryImage, cassowaryX, cassowaryY, cassowaryWidth, cassowaryHeight);

                    // Update positions for the background
                    x1 -= 2;
                    x2 -= 2;

                    // Reset positions when off-screen
                    if (x1 + backgroundImage.width * 2.5 <= 0) {
                        x1 = x2 + backgroundImage.width * 2.5;
                    }
                    if (x2 + backgroundImage.width * 2.5 <= 0) {
                        x2 = x1 + backgroundImage.width * 2.5;
                    }

                    requestAnimationFrame(draw);
                }

                draw();
            };
        };

        // Adjust canvas size on window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>